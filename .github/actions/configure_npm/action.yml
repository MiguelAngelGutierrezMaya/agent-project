name: Configure Node and npm
description: Set up Node.js and install npm dependencies for deployment (npm ci).

inputs:
  node-version:
    description: Node.js version to install.
    required: false
    default: '22.14.0'
  working-directory:
    description: Working directory where package.json is located.
    required: false
    default: ''

runs:
  using: composite
  steps:
    - name: Set up Node.js
      uses: actions/setup-node@v4
      with:
        node-version: ${{ inputs['node-version'] }}

    - name: Generate package-lock.json if missing
      shell: bash
      working-directory: ${{ inputs.working-directory }}
      run: |
        if [ ! -f package-lock.json ]; then
          echo "package-lock.json not found. Generating it..."
          npm install --package-lock-only
        fi

    - name: Install dependencies with npm ci
      shell: bash
      working-directory: ${{ inputs.working-directory }}
      run: |
        echo "Installing dependencies with npm ci..."
        npm ci

