###############################################################################
# Certbot Installation for Let's Encrypt SSL Certificates
#
# This installs certbot and python3-certbot-nginx automatically during deployment.
# After deployment, run certbot manually via SSH to get certificates.
#
###############################################################################

packages:
  yum:
    certbot: []
    python3-certbot-nginx: []

###############################################################################
# Setup Instructions (after deployment):
#
# Certbot is automatically installed during deployment (you don't need to install it).
# You only need to run certbot ONCE to get the SSL certificate:
#
# 1. Configure DNS in Cloudflare:
#    - Create A record: chat.migudev.com -> Your EB instance public IP
#    - Or use CNAME if you prefer (though A record is better for SSL)
#
# 2. Get your EB instance public IP:
#    - AWS Console -> EC2 -> Instances -> Your EB instance -> Public IPv4 address
#    - Or: eb ssh chat-service-development, then run: curl ifconfig.me
#
# 3. SSH into your EC2 instance:
#    eb ssh chat-service-development
#
# 4. Get SSL certificate (ONLY command you need to run manually):
#    sudo certbot --nginx -d chat.migudev.com
#
#    This will:
#    - Obtain SSL certificate from Let's Encrypt
#    - Automatically update nginx config with certificate paths
#    - Configure HTTP to HTTPS redirect
#    - Set up auto-renewal
#
# 5. Test certificate renewal:
#    sudo certbot renew --dry-run
#
# 6. Verify HTTPS is working:
#    curl https://chat.migudev.com/health
#
# IMPORTANT PREREQUISITES:
# - DNS must be configured and propagated (can take a few minutes)
# - Port 80 must be open for Let's Encrypt validation
# - After certbot setup, HTTP will redirect to HTTPS automatically
###############################################################################
